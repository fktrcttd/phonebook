# Телефонный справочник

Окружение
---------

1.  Scala, SBT.  
    Инструкцию по установке для Ubuntu 18.04 можно найти [здесь](http://www.codebind.com/linux-tutorials/install-scala-sbt-java-ubuntu-18-04-lts-linux/)
2.  PostgreSQL  
    Инструкцию по установке для Ubuntu 18.04 можно найти  [здесь](https://hostadvice.com/how-to/how-to-install-postgresql-database-server-on-ubuntu-18-04/). После установки необходимо создать пустую базу данных, например, через PgAdmin (приложение не умеет создавать БД, если ее нет). 
3.  Node и NPM  
    Инструкцию по установке для Ubuntu 18.04 можно найти  [здесь](https://linuxize.com/post/how-to-install-node-js-on-ubuntu-18.04/)
4.    
     

Запуск
------

1.  Клонировать [репозиторий ](https://github.com/fktrcttd/phonebook.git)
2.  Перейти в папку проекта
3.  Отредактировать конфигурационный файл conf/application.conf. В самом конце этого файла необходимо сконфигурировать подключение к серверу PostgreSQL: укзать имя пользователя, пароль, в URL jdbc указать адрес размещения сервера в сети, имя базы данных, созданной ранее. 
4.  Из командной строки выполнить команду "npm run start". 
5.  Приложение будет запущено по адресу http://localhost:9000/

Описание API
------------

1.                      GET     /api/phones - список всех номеров телефонов
                    
    
2.                      GET     /api/phone/getById - получить информацию о телефоне по ИД
                        При успешном поиске возвращает 200 ОК
                        При отсутствии номера телефона с соответствующим Id вернет 404 NOT FOUND
                    
    
3.                      GET     /api/phone/searchByName?term=... - поиск номеров по имени.
                        Работает как contains, а не startWith, без учета регистра. term - строка для поиска
                    
    
4.                      GET     /api/phone/searchByNumber?term=... - поиск номеров по номеру телефона.
                        Работает как contains, а не startWith, без учета регистра. term - строка для поиска.
                        Ищет номера буквально, т.е. чтобы найти +7 (902) ... нужно ввести "+7 (902)" со всеми пробелами и символами.&nbsp;
                    
    
5.                      POST     /api/phone/create - метод создания номера телефона.
                        В body запроса необходим JSON-объект следующего формата
                        {
                            "title": "ww",
                            "number": "www"
                        }
                        При успешном добавлении возвращает 200 ОК
                        При ошибке валидации (пустой title или неверный формат номера - НЕ +# (###) ##-##-###) вернет 400 BAD REQUEST
                    
    
6.                      POST     /api/phone/id - редактирование номера телефона по Id. 
                        При успешном редактировании возвращает 200 ОК
                        При ошибке валидации (пустой title или неверный формат номера - НЕ +# (###) ##-##-###) вернет 400 BAD REQUEST
                        При отсутствии номера телефона с соответствующим Id вернет 404 NOT FOUND
                    
    
7.                      DELETE     /api/phone/id  - удаление номера телефона по Id
                        При успешном удалении возвращает 200 ОК
                        При отсутствии номера телефона с соответствующим Id вернет 404 NOT FOUND
                    
    
8.                      GET     /api/writeall  - асинхронно записывает все номера телефонов в файл AllPhones.json в папке public. 
                        Содержимое файла доступно по адресу /assets/AllPhones.json
                    
    

Сценарии использования
----------------------

1.  Поиск: выберите параметр поиска радиокнопкой - номер телефона (по умолчанию) или имя, начните вводить символы в поисковую строку.  
    Список будет обновляться по мере набора поискового запроса с небольшой задержкой (debounce). Важно: поиск по номеру работает буквально, т.е. чтобы найти +7 (902) ... нужно ввести "+7 (902)" со всеми пробелами и символами. 
2.  Добавление: зеленая кнопка "Добавить" вызовет соответствующее модальное окно с валидируемыми полями. После отправки на сервер отобразиться результат в верхней части окна. По завершении (нажатие кнопки "Создать" список элементов будет обновлен)
3.  Запись в файл: по кнопке "Записать в файл" все данные справочника будут асинхронно записаны в файл AllPhones.json по пути "проект"/public/files/AllPhones.json. Результат операции отобразится в модальном окне. 
4.  Список: просто список. Без пагинации, фильтрации, сортировки. 
5.  Редактирование: по кнопке "Редактировать" откроется модальное окно с валидирумой формой. Результат отправки данных на сервер отобразится в верхней части окна. По завершении (нажатие кнопки "Ок" список элементов будет обновлен)
6.  Удаление: по кнопке "Удаление" будет вызвано модальное окно с подтверждением удаления записи. 

Дополнительно
-------------

Приложение разбито на две части - frontend и backend.  
Backend: Scala, Play framework 2. СУБД: PostgreSQL. ORM: Slick.   
Frontend:  Vue.js, Bootstrap 4. Реализован как одностраничное приложение ( single page application) - один HTML документ, все данные запрашиваются по AJAX без перезагрузки страниц.   
  
Что нравится: 

*   Реализация кэша - просто и кратко;
*   Нравится как работает и выглядит фронтенд. Нравится, что получилось сделать SPA;

  
Что можно улучшить: 

*   Фронтенд. Подробнее разбить на компоненты (сейчас один супер большой компонент - list.vue, который знает все обо всем)  
    Улучшить код (сейчас очень много булевых проверок для валидации и модальных окон)
*   Можно улучшить код на бэкенде: создать интерфейсы для классов (для кэша, например), передавать через Dependecy Injection, убрать или переписать неиспользуемый код в FileAsyncIO  (код с гитхаба, оставил так, как есть). Улучшить код с Future и ExecutionContext - делал по примерам, чтобы работало. 
*   Реализовать нереализованное: удаление записей через заданный промежуток времени после добавления 
*   Написать тесты.
